{# plausibility_card.html #}

<div class="alert alert-info shadow-lg mt-6" role="alert">
    <div class="w-full">

        <!-- Top line: main metric -->
        <h3 class="font-bold text-2xl flex flex-wrap items-center gap-2">
            <span class="font-mono">{{ plausibility_ratio }}×</span>

            <span class="tooltip tooltip-bottom"
                data-tip="Compares how typical the name is in {{ country }} versus all EU countries pooled. 1.0× means average.">
                <span class="underline decoration-dotted cursor-help">EU baseline</span>
            </span>

            <span class="badge ml-1
          {% if plausibility_ratio >= 1.5 %} badge-success
          {% elif plausibility_ratio >= 0.7 %} badge-neutral
          {% else %} badge-warning
          {% endif %}
        ">
                {{ plausibility_label }}
            </span>
        </h3>

        <!-- Summary -->
        <div class="text-lg mt-2 flex flex-wrap items-center gap-x-2 gap-y-1">
            <span class="opacity-80">Claimed country:</span>
            <strong>{{ country }}</strong>

            <span class="opacity-50">·</span>

            <span class="tooltip tooltip-bottom"
                data-tip="Estimated probability that this name matches {{ country }} (used to rank countries).">
                <span class="opacity-80 underline decoration-dotted cursor-help">
                    Probability: <span class="font-mono">{{ posterior_share_claimed_pct }}%</span>
                </span>
            </span>

            {% if claimed_rank and claimed_rank != "unknown" %}
            <span class="opacity-50">·</span>
            <span class="opacity-80">Rank:</span>
            <span class="font-mono">#{{ claimed_rank }}</span>
            {% endif %}
        </div>

        <!-- Message -->
        {% if message %}
        <div class="mt-3 italic opacity-80">{{ message }}</div>
        {% endif %}

        {% if ranked_countries and ranked_countries|length > 0 %}
        <div class="divider my-4"></div>

        <div class="mt-2">
            <div class="font-semibold text-base mb-2">Top matching countries</div>

            <ul class="space-y-2">
                {% for rc in ranked_countries %}
                <li class="flex items-center justify-between gap-4">
                    <div class="flex items-center gap-2 min-w-0">
                        <span class="badge badge-outline">{{ rc.rank }}</span>

                        <span class="font-medium truncate {% if rc.is_claimed %} underline decoration-2 {% endif %}">
                            {{ rc.country }}
                        </span>

                        {% if rc.is_claimed %}
                        <span class="badge badge-primary ml-1">Claimed</span>
                        {% endif %}
                    </div>

                    <!-- Right side: simple, readable stats -->
                    <div class="text-sm opacity-85 text-right whitespace-nowrap flex items-center gap-2">
                        <span class="tooltip tooltip-left"
                            data-tip="Number of records where this country is the best match for the first name.">
                            <span class="cursor-help">
                                <span class="font-mono">{{ rc.first_count }}</span> first
                            </span>
                        </span>

                        <span class="opacity-60">·</span>

                        <span class="tooltip tooltip-left"
                            data-tip="Number of records where this country is the best match for the last name.">
                            <span class="cursor-help">
                                <span class="font-mono">{{ rc.last_count }}</span> last
                            </span>
                        </span>

                        <span class="opacity-60">·</span>

                        <span class="tooltip tooltip-left"
                            data-tip="Estimated probability for this country (percentage).">
                            <span class="cursor-help">
                                <span class="font-mono">{{ rc.posterior_share_pct }}</span>%
                            </span>
                        </span>
                    </div>
                </li>
                {% endfor %}
            </ul>

            <div class="mt-3 text-sm opacity-70">
                Tip: Hover dotted-underlined terms for definitions.
            </div>
        </div>
        {% endif %}
    </div>
</div>